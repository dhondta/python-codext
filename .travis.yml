language: python
jobs:
  allow_failures:
    - arch: arm64
    - os: osx
    - python: nightly
  fast_finish: true
  include:
    - python: 2.7
    - python: 3.6
    - python: 3.7
    - python: 3.8
    - python: 3.9
    - python: nightly
    - os: windows
      language: shell
      before_install: choco install python2 --version 2.7.18
      env: PATH=/c/Python27:/c/Python27/Scripts:$PATH
    - os: windows
      language: shell
      before_install: choco install python --version 3.6.8
      env: PATH=/c/Python36:/c/Python36/Scripts:$PATH
    - os: windows
      language: shell
      before_install: choco install python --version 3.7.6
      env: PATH=/c/Python37:/c/Python37/Scripts:$PATH
    - os: windows
      language: shell
      before_install: choco install python --version 3.8.1
      env: PATH=/c/Python38:/c/Python38/Scripts:$PATH
    - os: windows
      language: shell
      before_install: choco install python --version 3.9.0
      env: PATH=/c/Python39:/c/Python39/Scripts:$PATH
    - python: 2.7
      arch: arm64
    - python: 3.6
      arch: arm64
    - python: 3.7
      arch: arm64
      dist: focal
    - python: 3.8
      arch: arm64
    - python: 3.9
      arch: arm64
    - python: nightly
      arch: arm64
    - os: osx
      language: objective-c
      env: PYENV_VERSION=2.7.18
    - os: osx
      language: objective-c
      env: PYENV_VERSION=3.6.8
    - os: osx
      osx_image: xcode11.3
      language: objective-c
      env: PYENV_VERSION=3.7.6
    - os: osx
      language: objective-c
      osx_image: xcode11.3
      env: PYENV_VERSION=3.8.1
    - os: osx
      osx_image: xcode11.3
      language: objective-c
      env: PYENV_VERSION=3.9.0
cache: pip
install:
  - python -m pip install --upgrade pip
  - pip install pytest
  - pip install pytest-cov
  - pip install coveralls
  - pip install markdown2
  - pip install six
  - pip install .
script: pytest --cov=codext --cov-report=term-missing tests
after_success: coveralls
